package com.test;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;

public class Exp2 {

	public static void main(String[] args) throws Exception {
		String url = "jdbc:mysql://localhost:3306/mladec";
		String user = "root";
		String pass = "root@39";
		
		//1. Load the driver class
		Class.forName("com.mysql.cj.jdbc.Driver");
		
		//2. Establish or connection object
		Connection con = DriverManager.getConnection(url,user,pass);
		
		//3.Create statement object
		Statement stmt = con.createStatement();
		
		String sql = "create table batsman(name varchar(50),age int,runs int,century int,half_century)";
		 stmt.execute(sql);
		            

		        // ---------- INSERT DATA (Batch) ----------
		        stmt.addBatch("insert into batsman values('Virat Kohli',35,13000,48,65)");
		        stmt.addBatch("insert into batsman values('Rohit Sharma',36,11000,31,58)");
		        stmt.addBatch("insert into batsman values('MS Dhoni',42,10500,16,73)");
		        stmt.addBatch("insert into batsman values('Sachin Tendulkar',50,18000,49,96)");

		        stmt.executeBatch();

		        String sql1 = "select * from batsman";
		        ResultSet rs = stmt.executeQuery(sql1);

		        while (rs.next()) {
		            System.out.println(
		                "Name: " + rs.getString(1) +
		                ", Age: " + rs.getInt(2) +
		                ", Runs: " + rs.getInt(3) +
		                ", Centuries: " + rs.getInt(4) +
		                ", Half-Centuries: " + rs.getInt(5)
		            );
		        }

		        // 5. Close connection
		        con.close();
		        System.out.println("Done.");
		    }
		}
	}

}
